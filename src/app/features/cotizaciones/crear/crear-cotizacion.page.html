<div class="page">

  <h1 class="text-center text-[--brand] text-4xl font-semibold mb-1">
    {{ editMode ? 'Editar Cotización' : 'Nueva Cotización' }}
  </h1>

  <p class="text-center text-zinc-500 mb-10">
    {{ editMode ? 'Sigue los pasos para editar la cotización' : 'Sigue los pasos para crear la cotización' }}
  </p>

  <div class="card max-w-5xl mx-auto p-6 md:p-10 rounded-3xl shadow-lg animate-fade-in">

    <!-- LOADING STATES -->
    <div *ngIf="loading" class="space-y-8">
      <div class="flex justify-center">
        <ui-skeleton width="80%" height="60px" borderRadius="12px"></ui-skeleton>
      </div>
      <div class="divider"></div>
      <div class="space-y-6">
        <ui-skeleton width="40%" height="24px"></ui-skeleton>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <ui-skeleton width="100%" height="48px" borderRadius="12px"></ui-skeleton>
          <ui-skeleton width="100%" height="48px" borderRadius="12px"></ui-skeleton>
        </div>
        <ui-skeleton width="100%" height="150px" borderRadius="12px"></ui-skeleton>
      </div>
      <div class="divider"></div>
      <div class="flex justify-between">
        <ui-skeleton width="120px" height="44px" borderRadius="22px"></ui-skeleton>
        <ui-skeleton width="140px" height="44px" borderRadius="22px"></ui-skeleton>
      </div>
    </div>

    <ng-container *ngIf="!loading">
      <wizard-stepper [current]="stepIndex()" (stepChange)="stepIndex.set($event)">
      </wizard-stepper>

      <div class="divider"></div>

      <div [ngSwitch]="stepIndex()">
        <step1-tipo-estudio *ngSwitchCase="0"></step1-tipo-estudio>
        <step2-datos *ngSwitchCase="1"></step2-datos>
        <step3-entregables *ngSwitchCase="2"></step3-entregables>
        <step4-resumen *ngSwitchCase="3"></step4-resumen>
      </div>

      <div class="divider"></div>

      <div class="flex justify-between mt-6">
        <div>
          <button *ngIf="stepIndex() === 0" class="btn btn-outline" (click)="cancel()">
            Cancelar
          </button>
          <button *ngIf="stepIndex() > 0" class="btn btn-outline" (click)="prev()">
            <lucide-icon name="arrow-left" class="w-4 h-4 mr-1"></lucide-icon>
            Anterior
          </button>
        </div>

        <button class="btn btn-primary" (click)="onNext()">
          <ng-container *ngIf="stepIndex() < 3">
            Siguiente
            <lucide-icon name="arrow-right" class="w-4 h-4 ml-1"></lucide-icon>
          </ng-container>
          <ng-container *ngIf="stepIndex() === 3">
            {{ editMode ? 'Editar cotización' : 'Crear' }}
            <lucide-icon name="check" class="w-4 h-4 ml-1"></lucide-icon>
          </ng-container>
        </button>
      </div>
    </ng-container>

  </div>
</div>