<div class="page space-y-8">

  <!-- Encabezado -->
  <header>
    <h1 class="text-[color:var(--brand)]">Inicio</h1>
    <p class="muted">Usuarios y actividad reciente.</p>
  </header>

  <!-- Card: Usuarios recientes -->
  <section class="card">

    <!-- Header card -->
    <div class="flex items-center justify-between mb-5">
      <div>
        <h3 class="text-lg font-semibold">Lista de usuarios</h3>
        <p class="text-sm muted">{{ usuarios().length }} usuarios registrados</p>
      </div>

      <a [routerLink]="['/admin/usuarios']" class="btn btn-dark h-9 px-4 rounded-full">
        Ver más
      </a>
    </div>

    <!-- Estados -->
    <div *ngIf="loadingUsers()" class="py-4 text-sm muted">Cargando…</div>
    <div *ngIf="!loadingUsers() && usersError()" class="py-4 text-sm text-red-600">
      {{ usersError() }}
    </div>

    <!-- Tabla -->
    <div *ngIf="!loadingUsers() && !usersError()" class="overflow-x-auto">
      <table class="table w-full">
        <thead>
          <tr>
            <th class="w-1/3">Nombre</th>
            <th class="w-1/3">Correo</th>
            <th class="w-28">Rol</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let u of usuarios()">
            <td>{{ u.name }} {{ u.lastName }}</td>
            <td class="truncate max-w-[260px] md:max-w-none">{{ u.email }}</td>
            <td>
              <span *ngIf="u.role"
                class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold text-white bg-[--brand]">
                {{ u.role | titlecase }}
              </span>
            </td>
          </tr>

          <tr *ngIf="usuarios().length === 0">
            <td colspan="3" class="py-4 text-center muted">Sin usuarios recientes</td>
          </tr>
        </tbody>
      </table>
    </div>

  </section>

  <!-- Card: Actividad reciente -->
  <!-- Card: Actividad reciente -->
  <section class="card">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-semibold">Actividad reciente</h3>
      <a routerLink="/admin/auditoria" class="text-sm text-[--brand] hover:underline">Ver todo</a>
    </div>

    <!-- Loading -->
    <div *ngIf="loadingAudit()" class="py-4 text-sm muted">Cargando actividad...</div>

    <!-- Empty -->
    <div *ngIf="!loadingAudit() && auditoria().length === 0" class="py-4 text-sm muted">
      No hay actividad reciente.
    </div>

    <ul *ngIf="!loadingAudit() && auditoria().length > 0" class="space-y-4 text-sm">
      <li *ngFor="let log of auditoria()" class="flex gap-3 border-b border-zinc-100 last:border-b-0 pb-3 last:pb-0">
        <!-- Icon placeholder or dot -->
        <div class="mt-1 w-2 h-2 rounded-full bg-[--brand] flex-shrink-0"></div>

        <div class="flex-1">
          <p class="text-zinc-900 font-medium leading-tight">{{ log.descripcion }}</p>
          <div class="flex items-center gap-2 mt-1 text-xs text-zinc-500">
            <span *ngIf="log.performedBy">{{ log.performedBy.name }} {{ log.performedBy.lastName }}</span>
            <span *ngIf="log.performedBy">•</span>
            <span>{{ log.createdAt | date:'medium' }}</span>
          </div>
        </div>
      </li>
    </ul>
  </section>

</div>