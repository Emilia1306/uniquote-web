<div class="max-w-[1400px] mx-auto px-6 py-6">

  <!-- HEADER -->
  <div class="flex justify-between mb-6">
    <div>
      <h1 class="text-3xl font-semibold">Proyectos</h1>
      <p class="muted">Listado de proyectos del cliente</p>
    </div>

    <div class="flex items-center gap-3">
      <button class="btn btn-primary" (click)="openCreateModal()">
        + Nuevo Proyecto
      </button>

      <!-- Vista -->
      <div class="flex gap-2">
        <button class="btn-icon"
                [class.opacity-60]="view() !== 'cards'"
                (click)="view.set('cards')">
          <svg viewBox="0 0 24 24" class="h-5 w-5">
            <path fill="currentColor"
              d="M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z"/>
          </svg>
        </button>

        <button class="btn-icon"
                [class.opacity-60]="view() !== 'table'"
                (click)="view.set('table')">
          <svg viewBox="0 0 24 24" class="h-5 w-5">
            <path fill="currentColor"
              d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- BUSCADOR -->
  <div class="mb-6">
    <input
      class="input w-full"
      placeholder="Buscar..."
      [(ngModel)]="searchText"
    />
  </div>

  <!-- LISTA -->
  <ng-container [ngSwitch]="view()">

    <!-- CARDS -->
    <proyectos-cards
      *ngSwitchCase="'cards'"
      [items]="filteredList()"
      (ver)="verDetalle($event)" 
      (editar)="openEditModal($event)"
      (eliminar)="eliminarProyecto($event)"  
    ></proyectos-cards>

    <!-- TABLA -->
    <proyectos-table
      *ngSwitchCase="'table'"
      [items]="filteredList()"
      (ver)="verDetalle($event)"
      (editar)="openEditModal($event)"
      (eliminar)="eliminarProyecto($event)"
    ></proyectos-table>

  </ng-container>
</div>

<!-- MODAL CREAR -->
<dialog id="modal-create" class="modal">
  <form method="dialog" class="modal-box p-6">
    <h3 class="text-xl mb-4">Crear Proyecto</h3>

    <label>Nombre</label>
    <input class="input mb-3" [(ngModel)]="modalName" name="newName"/>

    <label>Cliente ID</label>
    <input class="input mb-3" type="number" [(ngModel)]="modalClienteId" name="newCliente"/>

    <label>Contacto ID</label>
    <input class="input mb-3" type="number" [(ngModel)]="modalContactoId" name="newContacto"/>

    <div class="flex justify-end gap-2 mt-4">
      <button class="btn" type="button" (click)="closeCreateModal()">Cancelar</button>
      <button class="btn btn-primary" type="button" (click)="crearProyecto()">Guardar</button>
    </div>
  </form>
</dialog>

<!-- MODAL EDITAR -->
<dialog id="modal-edit" class="modal">
  <form method="dialog" class="modal-box p-6">
    <h3 class="text-xl mb-4">Editar Proyecto</h3>

    <label>Nombre</label>
    <input class="input mb-3" [(ngModel)]="editName" name="editName"/>

    <label>Cliente ID</label>
    <input class="input mb-3" type="number" [(ngModel)]="editClienteId" name="editClienteId"/>

    <label>Contacto ID</label>
    <input class="input mb-3" type="number" [(ngModel)]="editContactoId" name="editContactoId"/>

    <div class="flex justify-end gap-2 mt-4">
      <button class="btn" type="button" (click)="closeEditModal()">Cancelar</button>
      <button class="btn btn-primary" type="button" (click)="guardarCambios()">Guardar cambios</button>
    </div>
  </form>
</dialog>
